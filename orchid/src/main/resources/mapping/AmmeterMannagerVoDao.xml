<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.ih2ome.hardware_service.service.dao.AmmeterMannagerVoDao">

    <select id="findConcentratAmmeter" parameterType="com.ih2ome.hardware_service.service.vo.AmmeterMannagerVo" resultType="com.ih2ome.hardware_service.service.vo.AmmeterMannagerVo">
      SELECT DISTINCT csd.id ammeterId, ch.area apartmentName, cau.last_name landlordName, cau.username authUserName, ch.address houseAddress, cr.`name` roomNo, crc.customer_name customerName, crc.customer_phone customerPhone, csd.`name` deviceName, csd.`status` communicationStatus FROM caspain_test.room_contract crc, caspain_test.room cr, caspain_test.house ch, caspain_test.house_contract chc, caspain_test.auth_user cau, caspain_test.smart_device csd WHERE chc.house_id = ch.id AND cr.house_id = ch.id AND crc.room_id = cr.id AND chc.created_by_id = cau.id AND csd.room_id = cr.id AND csd.is_delete = '0' AND ch.is_delete = '0' AND chc.is_delete = '0' AND cr.is_delete = '0' AND crc.is_delete = '0'
        <if test="ammeterId != '' and ammeterId != null">
            AND csd.id = '${ammeterId}'
        </if>
        <if test="apartmentName != '' and apartmentName != null">
            AND ch.area LIKE '%${apartmentName}%'
        </if>
        <if test="landlordName != '' and landlordName != null">
            AND cau.last_name LIKE '%${landlordName}%'
        </if>
        <if test="customerName != '' and customerName != null">
            AND crc.customer_name LIKE '%${customerName}%'
        </if>
        <if test="deviceName != '' and deviceName != null">
            AND csd.`name` LIKE '%${deviceName}%'
        </if>
        <if test="authUserName != '' and authUserName != null">
            AND cau.username LIKE '%${authUserName}%'
        </if>
        <if test="customerPhone != '' and customerPhone != null">
            AND crc.customer_phone LIKE '%${customerPhone}%'
        </if>
        <if test="cityName != '' and cityName != null">
            AND ch.city LIKE '%${cityName}%'
        </if>
        <if test="districtName != '' and districtName != null">
            AND ch.district LIKE '%${districtName}%'
        </if>
        <if test="areaName != '' and areaName != null">
            AND ch.area LIKE '%${areaName}%'
        </if>
        <if test="communicationStatus != '' and communicationStatus != null">
            AND csd.`status` LIKE '%${communicationStatus}%'
        </if>
    </select>
</mapper>